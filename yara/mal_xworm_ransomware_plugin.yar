import "dotnet"
import "pe"

rule mal_XWorm_ransomware_plugin_note
{
    meta:
        author = "Tony Lambert (@ForensicITGuy)"
        date = "2024-06-02"
        description = "Detect strings seen in XWorm ransomware plugin note."
        hash = "501b2bee6f8c330412996ab247c88bcf402204a64b41464cf4a3f93693977282"
    strings:
        $s1 = "Oops All Your Files Are Encrypted" ascii wide
        $s2 = "To The Wallet : " ascii wide
        $s3 = "Contact Me At Email To Decrypt Files : " ascii wide
        $s4 = "See You Soon !" ascii wide
    condition:
        all of them
}

rule mal_XWorm_ransomware_plugin_metadata
{
    meta:
        author = "Tony Lambert (@ForensicITGuy)"
        date = "2024-06-02"
        description = "Detect unaltered metadata seen in XWorm ransomware plugin DLL."
        hash = "501b2bee6f8c330412996ab247c88bcf402204a64b41464cf4a3f93693977282"
    condition:
        pe.version_info["FileDescription"] == "Ransomware" and
        pe.version_info["CompanyName"] == "" and
        pe.version_info["InternalName"] == "Ransomware.dll" and
        pe.version_info["OriginalFilename"] == "Ransomware.dll" and
        dotnet.module_name == "Ransomware.dll" and
        dotnet.assembly.name == "Ransomware"
}
