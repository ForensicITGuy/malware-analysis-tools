#!/usr/bin/env python3

# Author: Tony Lambert (@ForensicITGuy)

from dotnetfile import DotNetPE
import argparse
import json

parser = argparse.ArgumentParser()
parser.add_argument("-f", "--file", help="path of the binary file", required=True)
args = parser.parse_args()

dotnet_file_path = args.file
dotnet_file = DotNetPE(dotnet_file_path)
data = dotnet_file.get_user_stream_strings()

json_data = {
    "BotToken" : data[-2],
    "Guild ID" : data[-1]
}

json_output = json.dumps(json_data, indent=4)

print(json_output)
